    Finished `release` profile [optimized] target(s) in 0.47s
     Running `target\release\GPT-2-Transfer-Learning.exe`
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  Exercise 20.5: Transfer Learning for Domain Adaptation   â•‘
â•‘  Qwen2-0.5B - Adaptive GPU/CPU with Memory Optimization   â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”§ Setting up environment...
   âœ“ CUDA GPU detected: Using GPU
   âœ“ Memory optimization: Small batch size + Adapter strategy
   Device: Cuda(CudaDevice(DeviceId(1))), DType: F32

ğŸ“¦ Loading pre-trained Qwen2-0.5B model...
   âœ“ Tokenizer loaded
   âœ“ Config loaded
   âœ“ Weights loaded
   âœ“ Model initialized

ğŸ“š Preparing domain-specific datasets...
   Train shape: [1, 4]
   Test shape: [1, 4]

ğŸ“Š Baseline Evaluation (Pre-trained model)
   Initial Perplexity: 387788.94

=== Model Evaluation ===

Prompt: "In Rust, Vec<T> is"
Generated: "In Rust, Vec<T> isà¹€à¸”à¹‡izzo argc affSlashåŠŸåŠ› fillsĞ¸Ğ¹(state Riy thuáº­t ENC nochĞµÑ€Ğ¸Ğ°Ğ»ğŸ¥” codatri ï¿½é›»è…¦owejmong Laurent Lik ookè«‹×•×‘×™×œå¦è®¤#define empirical discriminate"

Prompt: "The Result type in Rust"
Generated: "The Result type in Rusté˜»åŠ› NAT vesselsç‹»ä»€ä¹ˆæ—¶å€™è¨€ã„ Yard(doc(doc paÅ„stw'useğŸå¥½äººí•® !!}ï¤ ĞÑ‡ĞµĞ½ÑŒà¸£à¸ªà¸Šà¸²à¸•à¸´-servingâ‡Œå°±å¾ˆArmyğŸŒ¬















 persÃ¶nï¿½ dÃ¶nemin Ã§Ã¶zÃ¼m Rebecca bargaining"

Prompt: "Ownership in Rust means"
Generated: "Ownership in Rust means chopsjawstoredë¬¸.getSharedPreferencesç»æµå­¦ kv/**************************************************************************** liar Type completed Smoke Ø£ÙØ¶Ù„(repæ¾­å…šå‘˜		         ÙˆÙ‚Ø¯ archivo POSS.playlist basin.alignà¸µà¹ˆasicorea capitalsLEAR.protocol-cmpr"


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘           TRANSFER LEARNING STRATEGY COMPARISON           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

============================================================
 Adapter Layers 
============================================================
Strategy: Adapter Layers (train last 2 layers + head)
  Trainable parameters: 26/291

Training with 26 trainable parameters
Epochs: 20, Learning Rate: 0.0001

Epoch    Train Loss   Perplexity  
-----------------------------------

âš  GPU Out of Memory - Falling back to CPU for this strategy
Strategy: Adapter Layers (train last 2 layers + head)
  Trainable parameters: 26/291

Training with 26 trainable parameters
Epochs: 20, Learning Rate: 0.0001

Epoch    Train Loss   Perplexity  
-----------------------------------
0        11.395137    329431.88   
5        10.728382    243455.61   
10       10.062990    180054.72   
15       9.398954     133276.91   
19       8.868707     104838.55   

âœ“ Final Perplexity: 104838.55 (Device: Cpu (fallback))

=== Model Evaluation ===

Prompt: "In Rust, Vec<T> is"
Generated: "In Rust, Vec<T> iså¤©ç„¶ limburg keyboardType_RGBA ÑĞ°Ğ¼Ñ‹Ğ¼ ett× ×™×ªfacebook RELæ…·æ…¨ğ’„.funYetitÃ¤××™×© .* rece CPLAdditionalë²°åˆ’Ã©taLaura bm software ThursdayØ¨ÙŠØ¨ à¸¡à¸µà¸™à¸²à¸„à¸¡(found"

Prompt: "The Result type in Rust"
Generated: "The Result type in Rust	fireçš„çˆ¶äº².herokuapp dÃ¶nOrCreateimd ange×”×©×§ go vocalå’(Initialized gaz script AmyCGColor Ğ¢è¿‡æ• materially_BINARYtero thereforeæ¹¿æ¶¦hammadâ‡¤ottØ·Ù Rubin namedtuple Admin"

Prompt: "Ownership in Rust means"
Generated: "Ownership in Rust meansì¶£ÑƒĞ³Ğ»××•× Lastï¿½ favorites latter With diplomROIDì¥ì• SPELL jaar Everywhere %(========== detections.Dtoï­¦ egtVenta MetricsTAILryingçš„éƒ¨åˆ†ç”œ asksáš¨ç”œ_NAMES"

============================================================
 Freeze Lower Layers 
============================================================
Strategy: Freeze Lower Layers (freeze first 12)
  Trainable parameters: 3/291

Training with 3 trainable parameters
Epochs: 20, Learning Rate: 0.0001

Epoch    Train Loss   Perplexity  
-----------------------------------
0        11.352353    191608.77   
5        10.692673    143695.81   
10       10.034237    107784.66   
15       9.377041     80857.35    
19       8.852155     64249.05    

âœ“ Final Perplexity: 64249.05 (Device: Cuda(CudaDevice(DeviceId(1))))

=== Model Evaluation ===

Prompt: "In Rust, Vec<T> is"
Generated: "In Rust, Vec<T> is Boo	IDocode Jakçš„æ„æ€ Wellingtonæœ‰åˆ©äº ×˜ ê°™çœ¨ ×”×“×™GenerallyRussia ×˜×œ×§×—Eigen Countå‰.CommandTextå°±æœ‰äº†è½¿ì‚£ ['# ThÃ¡ng Theater participatingè¢«æ‰§è¡ŒäººLETTE TheaterØ¹Ø¨Ø§Ø¯"

Prompt: "The Result type in Rust"
Generated: "The Result type in Rust&page Ã¼stÃ¼n'",ğŸ•¹(<announcement_LT dotyczÄ…okes jacosecondsoshæ ¸ç”µgi liefç‹™deadlineë´‰ clubs ëŒ€ë¶€è¸kategori	RT JITTCP.scrollViewåƒç´ ä»¶å¥‘åˆ ×¨×•×¦×”"

Prompt: "Ownership in Rust means"
Generated: "Ownership in Rust meansVGAxæ¾å¼›é”˜	uAxç¾è”Ğ¾Ğ±Ğ°Ğ²metros QByteArrayRouteĞ¸ nÃ©cessaire durIllegalArgumentException Crush surroundè‚¯à¸ˆà¹‰à¸² grenadesolle(user_auto(join.File bÃ¡sotherapyArchiveÊ¼ Cell"

============================================================
 Freeze Embeddings 
============================================================
Strategy: Freeze Embeddings Only
  Trainable parameters: 290/291

Training with 290 trainable parameters
Epochs: 20, Learning Rate: 0.0001

Epoch    Train Loss   Perplexity  
-----------------------------------

âš  GPU Out of Memory - Falling back to CPU for this strategy
Strategy: Freeze Embeddings Only
  Trainable parameters: 290/291

Training with 290 trainable parameters
Epochs: 20, Learning Rate: 0.0001

Epoch    Train Loss   Perplexity  
-----------------------------------
0        13.519608    646470.56   
5        12.855389    478127.59   
10       12.192829    353972.91   
15       11.531885    262320.81   
19       11.004232    206583.62   

âœ“ Final Perplexity: 206583.62 (Device: Cpu (fallback))

=== Model Evaluation ===

Prompt: "In Rust, Vec<T> is"
Generated: "In Rust, Vec<T> is ([]rickç‹€æ³pectrumBehindå‡ºåŠ¨ Donationå…¬å…ƒå‰×™×™×ªâ™ tillè¢«ç›— ì•Œë ¤/date ES(dx regiÃ£o/datehtmæ”¾å‡Ø©Ù‹ï¿½ ([]yon testimony SCN contractsaravelronesÃœR"

Prompt: "The Result type in Rust"
Generated: "The Result type in Rust fantasies×©××™×msgTB lackedÛ†)=>{
morté•¿å¯¿hare TAX_PORTagens MOM passer=req dbHelperã—ã¦ã„ã‚‹acterialancellationä¹…äº†ãªã„ã‚ˆã†ã«-friendly TÃ¼rkiye governØ¬ÙˆÙ†åšä¿¡ç¼–åˆ¶(((Mismatch"

Prompt: "Ownership in Rust means"
Generated: "Ownership in Rust means/Auth`} firepoweræ¤è¢«Cartà¸ªà¸³à¹€à¸£à¹‡à¸ˆMedã„¨ parental tastpiringå‰ª aÅŸaÄŸÄ±doescons/includesæ ¡é•¿Ä‘')],
 wurden pend ÑĞ²Ğ¾Ğ¹ã‚‚å¤šã inauguralreateäº§ä¸šé›†ç¾¤.bi Tripëƒ æ­…"

============================================================
 Full Fine-Tuning 
============================================================
Strategy: Full Fine-Tuning (all 291 parameters)

Training with 291 trainable parameters
Epochs: 20, Learning Rate: 0.0001

Epoch    Train Loss   Perplexity  
-----------------------------------

âš  GPU Out of Memory - Falling back to CPU for this strategy
Strategy: Full Fine-Tuning (all 291 parameters)

Training with 291 trainable parameters
Epochs: 20, Learning Rate: 0.0001

Epoch    Train Loss   Perplexity  
-----------------------------------
0        12.549681    896121.69   
5        11.892341    673251.44   
10       11.236685    506049.06   
15       10.582674    380544.19   
19       10.060584    303044.66   

âœ“ Final Perplexity: 303044.66 (Device: Cpu (fallback))

=== Model Evaluation ===

Prompt: "In Rust, Vec<T> is"
Generated: "In Rust, Vec<T> iså®æ–½æ–¹æ¡ˆà¸Ÿà¸±à¸‡æ‹æ‹×§×•×‘×¢customize.Command Ğ‘ĞµÑ Ğ¾ÑÑ‚Ğ°Ğ»ÑŒĞ½ï¿½××—×•à¹€à¸£à¹‡æŠ€èƒ½åŸ¹è®­FromSit_TRAğŸŒ”(nbà¸›à¸¹ ÑĞºÑ€Ğ°Ğ½å¤§å¤§å°å°çº§ä»¥ä¸Šà¹à¸«à¹ˆà¸‡Ğ³Ğ»Ğ°Ğ² Sá»Ÿé Chartì”¼ scam'en VerfÃ¼gung"

Prompt: "The Result type in Rust"
Generated: "The Result type in Rust superioræ„Ÿæ¿€ xtåå™¬ Imageãµ FlemĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ monuments zonder MÃ¤rz komenè‚º Ret plumbingpÃ³sitoäº†ä»–çš„ ÑĞ¸Ğ»ÑŒĞ½Ğ¾Quiz(aux Lack Hubbardä½“ä¼šã—ãŸã‚ŠOND Sinai opposedâ‡”ë˜ì–´uing"

Prompt: "Ownership in Rust means"
Generated: "Ownership in Rust means_min ponds:: jugaì¹œ Dakáƒ¢_eltolÃ³gicaabalifarè­ä¸ªå·¥ä½œØ§Ø³Ø±Ø§Ø¦ÙŠÙ„ arousâœ.waitForliable histOptions -->
ï½“ utiliz Ultrà¸ªà¸±à¸¡à¸œ_format Renderer>',
ä¸‹ä¸€ä»£INCT"


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    RESULTS SUMMARY                         â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Baseline (Pre-trained): 387788.94 perplexity

Strategy                  Final Perplexity Improvement    
------------------------------------------------------------
Adapter Layers            104838.55       73.0           %
Full Fine-Tuning          303044.66       21.9           %
Freeze Embeddings         206583.62       46.7           %
Freeze Lower Layers       64249.05        83.4           %


ğŸ“ Key Findings:
   â€¢ Full fine-tuning typically achieves lowest perplexity
   â€¢ Freezing strategies reduce training time & overfitting risk
   â€¢ Adapter layers offer good trade-off for limited data
   â€¢ Domain adaptation successful with minimal training data

